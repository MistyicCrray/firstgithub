<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="author" content="order by dede58.com" />
		<title>会员登录</title>
		<link rel="stylesheet" type="text/css" href="resource/css/style.css">
		<link rel="stylesheet" type="text/css" href="resource/css/login.css">

	</head>

	<body>
		<div id="app">
			<!-- login -->
			<div class="top center">
				<div class="logo center">
					<a href="./index.html" target="_blank"><img src="resource/image/mistore_logo.png" alt=""></a>
				</div>
			</div>
			<form class="form center" id="UserLoginForm" @submit.prevent="submit">
				<div class="login">
					<div class="login_center">
						<div class="login_top">
							<div class="left fl">会员登录</div>
							<div class="right fr">您还不是我们的会员？
								<a href="./register.html" target="_self">立即注册</a>
							</div>
							<div class="clear"></div>
							<div class="xian center"></div>
						</div>
						<div class="login_main center">
							<div class="username">用户名:&nbsp;<input class="shurukuang" type="text" v-model="inputtext.username" name="username" placeholder="请输入你的用户名" /></div>
							<div class="username">密&nbsp;&nbsp;&nbsp;&nbsp;码:&nbsp;<input class="shurukuang" v-model="inputtext.password" type="password" name="password" placeholder="请输入你的密码" /></div>
							<div class="username">
								<div class="left fl">
									<!--验证码:&nbsp;<input type="text" placeholder="请输入验证码（不区分大小写,点击图片刷新）" placeholder="请输验证码" class="shurukuang" id="input-val">-->
								</div>
							</div>
						</div>
						<div class="login_submit">
							<button class="submit" type="submit">立即登录</button>
						</div>
					</div>
				</div>
			</form>
			<footer>
				<div class="copyright">简体 | 繁体 | English | 常见问题</div>
				<div class="copyright">小米公司版权所有-京ICP备10046444-<img src="resource/image/ghs.png" alt="">京公网安备11010802020134号-京ICP证110507号</div>

			</footer>
		</div>
		<script type="text/javascript" src="resource/js/vue-2.5.17.min.js"></script>
		<script type="text/javascript" src="resource/js/axios-0.18.min.js"></script>
		<script type="text/javascript" src="resource/js/vue-main.js"></script>
		<script type="text/javascript" src="resource/js/moment.min.js"></script>
		<script type="text/javascript" src="resource/js/jquery.min.js"></script>
		<script type="text/javascript">
			axios.defaults.baseURL = 'http://localhost:8080';
			var app = new Vue({
				el: '#app',
				data: {
					user: {},
					islogin: sessionStorage.length > 0,
					inputtext: {
						username: '',
						password: ''
					}
				},
				addCookie: function(username, password, value) {

				},
				// 在 `methods` 对象中定义方法
				methods: { // 获取类别信息
					logout: function() {
						logout();
						location.href = "login.html";
					},
					getCookie: function() {
						var _this = this;
						var app = new Array();
						var result = document.cookie.split(",");
						for(var i = 0; i < result.length; i++) {
							app[i] = result[i];
						}
						_this.inputtext.password = app[0];
						_this.inputtext.username = app[1];
						_this.inputtext.remenber = app[2];
						//  自动登录
						/*_this.inputtext.autologin = app[3];
						if(_this.inputtext.autologin) {
							setTimeout(function() {
								if(confirm("自动登录中请稍后...")) {
									_this.submit();
								}
							}, 1);

						}*/
					},
					submit: function() {
						var _this = this;
						console.info(_this.inputtext);
						axios.post('/user/Login', $("#UserLoginForm").serialize())
							.then(function(response) {
								var resultdata = response.data;
								sessionStorage.setItem("userId", resultdata.data.id);
								sessionStorage.setItem("userName", resultdata.data.username);
								sessionStorage.setItem("accessToken", resultdata.data.accessToken);
								if(_this.inputtext.remenber) {
									document.cookie = _this.inputtext.password + "," + _this.inputtext.username + "," + true;
								} else {
									document.cookie = "";
								}
								if(_this.inputtext.autologin) {
									document.cookie = _this.inputtext.password + "," + _this.inputtext.username + "," + true + "," + true;
								}
								alert("登录成功");
								window.location.href = '/cpts_1293_byy/index.html'; // 跳转
							})
							.catch(function(err) {

							});
					}
				},
				mounted: function() {
					this.getCookie();
				}
			})
		</script>
	</body>

</html>